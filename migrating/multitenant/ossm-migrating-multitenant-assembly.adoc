:_mod-docs-content-type: ASSEMBLY
[id=ossm-migrating-multitenant-assembly]
= Multitenant migration guide
include::_attributes/common-attributes.adoc[]
:context: ossm-migrating-multitenant-assembly

toc::[]

This guide is for users who are currently running a multitenant deployment of {SMProductName} {SMv2Version}, and are migrating to {SMProduct} 3.0.

[IMPORTANT]
====
If you have not completed the premigration checklists, you must complete them first before you can start migrating your deployment.
====

include::modules/ossm-migrating-a-multitenant-deployment.adoc[leveloffset=+1]
include::modules/ossm-migrating-multitenant-workloads.adoc[leveloffset=+1]

.Next steps

If you are using gateways, you must migrate them before you complete the migration process for your deployment and workloads.

* Migrate gateways
//<insert exref to gateway migration content>
//xrefs across Migration Guides will be handled by OSSM-8852

If you are not using gateways, and have verified your mulitenant migration, you can proceed to complete the migration and remove {SMProduct} 2 resources.

* Cleanup {SMProduct} 2
//<insert exref to done dir>
//xrefs across Migration Guides will be handled by OSSM-8852

include::modules/ossm-migrating-multitenant-with-cert-manager.adoc[leveloffset=+1]
include::modules/ossm-migrating-multitenant-workloads-with-cert-manager.adoc[leveloffset=+1]

.Next steps

If you are using gateways, you must migrate them before you can complete the migration process for your deployment and workloads.

* Migrate gateways
//<insert exref to gateway migration content>
//xrefs across Migration Guides are handled by OSSM-8852

After you have migrated your gateways, you must update the `app.controller.configmapNamespaceSelector` field in your `istio-csr` deployment.

If you are not using gateways, you can complete your migration with cert-manager.

* Complete your migration with cert-manager
//<insert exreft to complete-cert-manager>
//xrefs across Migration Guides will be handled by OSSM-8852


//Migration likely to resemble https://docs.openshift.com/container-platform/4.17/migrating_from_ocp_3_to_4/about-migrating-from-3-to-4.html#about-migrating-from-3-to-4 when done for OSSM 3.0 GA.