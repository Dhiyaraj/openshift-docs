// Module included in the following assemblies:
//
// * work_with_shared_resources/using-shared-resource-csi-driver.adoc

:_mod-docs-content-type: PROCEDURE

[id="ephemeral-storage-using-a-sharedconfigmap-object-in-a-pod_{context}"]
= Using a SharedConfigMap instance in a pod

To access a `SharedConfigMap` custom resource (CR) instance from a pod, you grant a given service account role-based access control (RBAC) permissions to use that `SharedConfigMap` CR instance.

.Prerequisites

* You have created a `SharedConfigMap` CR instance for the config map that you want to share across namespaces in the cluster.
* You must have permissions to perform the following actions:
** Get the list of the `SharedConfigMap` CR instances by entering the `oc get sharedconfigmaps` command.
** Check if a service account is allowed to use the `SharedSecret` CR and the service account is listed in your namespace by running the `oc adm policy who-can use <sharedsecret_identifier>` command.
** Confirm that the service account of your pod is allowed to use `csi` volumes. If you created the pod as a user, confirm that you are allowed to use `csi` volumes.

[NOTE]
====
If you are unable to complete the last two prerequisites, the cluster administrator can establish the necessary role-based access control (RBAC) so that you can enable service accounts to use the `SharedConfigMap` CR.
====

.Procedure

. Create the `RoleBinding` object associated with the role and grant the permission to your service account to use the shared resource. See the following example configuration:
+
[source,yaml]
----
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: use-shared-config
  namespace: <app_namespace> <1>
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: use-shared-config
subjects:
  - kind: ServiceAccount
    name: <service_account_name> <2> 
----
<1> Replace <app_namespace> with the namespace name of your application.
<2> Specify the service account name of your application.

. Mount the shared resource `csi` driver into a pod or any other resource that accepts `csi` volumes. See the following example configuration:
+
[source,yaml]
----
apiVersion: v1
kind: Pod
metadata:
  name: example-shared-config
  namespace: <app_namespace> <1>
spec:
  ...
  serviceAccountName: default
  volumes:
    - name: shared-config
      csi:
        readOnly: true 
        driver: csi.sharedresource.openshift.io
        volumeAttributes:
          sharedConfigMap: share-test-config <2>
----
<1> Replace <app_namespace> with the namespace name of your application.
<2> Defines the name of the `sharedConfigMap` object. 