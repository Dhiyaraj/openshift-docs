// This module is included in the following assemblies:
// * release_notes/op-release-notes-1-17.adoc

:_mod-docs-content-type: REFERENCE
[id="op-release-notes-1-17_{context}"]
= Release notes for {pipelines-title} General Availability 1.17

With this update, {pipelines-title} General Availability (GA) 1.17 is available on {OCP} 4.15 and later versions.

[id="new-features-1-17_{context}"]
== New features

In addition to fixes and stability improvements, the following sections highlight what is new in {pipelines-title} 1.17:

[id="pipelines-new-features-1-17_{context}"]
=== Pipelines

* With this release, you can configure multiple Git providers by using the Git resolver, or you can add multiple configurations for the same Git provider, in the `TektonConfig` custom resource (CR). You can then specify a Git configuration to use in different task runs and pipeline runs by using the `configKey` parameter.
+
.Example of multiple Git provider configurations
[source,yaml]
----
apiVersion: operator.tekton.dev/v1alpha1
kind: TektonConfig
metadata:
  name: config
spec:
# ...
  pipeline:
    git-resolver-config:
      # configuration 1
      fetch-timeout: "1m"
      default-url: "https://github.com/tektoncd/catalog.git"
      default-revision: "main"
      scm-type: "github"
      server-url: ""
      api-token-secret-name: ""
      api-token-secret-key: ""
      api-token-secret-namespace: "default"
      default-org: ""
      # configuration 2
      test1.fetch-timeout: "5m"
      test1.default-url: ""
      test1.default-revision: "stable"
      test1.scm-type: "github"
      test1.server-url: "api.internal-github.com"
      test1.api-token-secret-name: "test1-secret"
      test1.api-token-secret-key: "token"
      test1.api-token-secret-namespace: "test1"
      test1.default-org: "tektoncd"
      # configuration 3
      test2.fetch-timeout: "10m"
      test2.default-url: ""
      test2.default-revision: "stable"
      test2.scm-type: "gitlab"
      test2.server-url: "api.internal-gitlab.com"
      test2.api-token-secret-name: "test2-secret"
      test2.api-token-secret-key: "pat"
      test2.api-token-secret-namespace: "test2"
      test2.default-org: "tektoncd-infra"
# ...
----
+
.Example of using a `test1` configuration in a pipeline run
[source,yaml]
----
apiVersion: tekton.dev/v1
kind: PipelineRun
metadata:
  name: example
spec:
  pipelineRef:
    resolver: git
    params:
    # ...
    - name: configKey
      value: test1
# ...
----

* With this update, you can now monitor the running `PipelineRun` resources at the namespace, pipeline, and pipeline run level, in addition to the cluster level. You can configure the level through the `TektonConfig` custom resource by setting the `metrics.running-pipelinerun.level` parameter value to `namespace`, `pipeline`, or `pipelinerun`. The default value is empty, which sets the monitoring at cluster level.
+
.Example of monitoring the running pipeline run at the namespace level
[source,yaml]
----
apiVersion: operator.tekton.dev/v1alpha1
kind: TektonConfig
metadata:
  name: config
spec:
  pipeline:
    # ...
    metrics.running-pipelinerun.level: namespace
# ...
----

[id="operator-new-features-1-17_{context}"]
=== Operator

* With this update, you can run the `skopeo-copy` command with additional arguments, for example, `--all` and `--preserve-digests`. You can pass these arguments as a space-separated string, as shown in the following example:
+
.Example command
[source,terminal]
----
$ tkn task start skopeo-copy -p ARGS="--all --preserve-digests"
----

[id="pac-new-features-1-17_{context}"]
=== {pac}

* With this update, the `pipelines_as_code_running_pipelineruns_count` metric is added to show the number of running `PipelineRun` resources in {pac}. The metric can be filtered by repository or by namespace.

* With this update, the `pipelines_as_code_pipelinerun_duration_seconds_sum` metric is added to show the total duration in seconds taken by all `PipelineRun` resources in {pac}. The metric can be filtered by repository, namespace, `PipelineRun` status, and `PipelineRun` status change reason.

[id="tekton-chains-new-features-1-17_{context}"]
=== {tekton-chains}

* With this update, you can configure the `TektonConfig` custom resource (CR) to generate the `x509` key pair of the `ecdsa` type and use it with {tekton-chains} to sign artifacts. You can generate the key pair by setting the the `generateSigningSecret` field in the `TektonConfig` custom resource (CR) to `true`:
+
.Example of creating an `ecdsa` key pair
[source,yaml]
----
apiVersion: operator.tekton.dev/v1
kind: TektonConfig
metadata:
  name: config
spec:
# ...
  chain:
    disabled: false
    generateSigningSecret: true
# ...
----

* Before this update, if you did not configure {tekton-chains} in the `TektonConfig` CR, the Operator would not pass any default Chains configuration.
With this update, if you do not configure {tekton-chains} in the `TektonConfig` CR, the Operator sets the {tekton-chains} configuration with these default properties:
+
[source,yaml]
----
apiVersion: operator.tekton.dev/v1
kind: TektonConfig
metadata:
  name: config
spec:
# ...
  chain:
    artifacts.taskrun.format: in-toto
    artifacts.taskrun.storage: oci
    artifacts.oci.storage: oci
    artifacts.oci.format: simplesigning
    artifacts.pipelinerun.format: in-toto
    artifacts.pipelinerun.storage: oci
# ...
----

* With this update, {tekton-chains} now supports extracting the `mongo-server-url` URL from a specified file that can have any name. You can now use the `storage.docdb.mongo-server-url-path` parameter pointing to a valid file path within the container.

[id="breaking-changes-1-17_{context}"]
== Breaking changes

* With this update, the deprecated `ClusterTask` resource is removed from the Operator. As an alternative, you can use the cluster resolver to access tasks that {pipelines-shortname} installs in the `openshift-pipelines` namespace.
+
[IMPORTANT]
====
Before upgrading to {pipelines-shortname} 1.17, if you configured any pipelines that use `ClusterTask` resources, you must edit them to use the tasks in the `openshift-pipelines` namespace. Otherwise, after the upgrade, the pipelines will fail.

For more information about using the tasks in the `openshift-pipelines` namespace, see xref:../create/remote-pipelines-tasks-resolvers.adoc#resolver-cluster-tasks-ref_remote-pipelines-tasks-resolvers[Tasks provided in the OpenShift Pipelines namespace].
====

* With this update, the community cluster tasks are removed from the Operator. As an alternative, you can download them from the link:https://github.com/tektoncd/catalog[Tekton catalog] (GitHub resource). The community cluster tasks are planned to be added as tasks in a future release. The following list shows the removed community cluster tasks:

** `argocd-task-sync-and-wait`
** `git-cli`
** `helm-upgrade-from-repo`
** `helm-upgrade-from-source`
** `jib-maven`
** `kubeconfig-creator`
** `pull-request`
** `trigger-jenkins-job`

[id="fixed-issues-1-17_{context}"]
== Fixed issues

* With this update, the {pac} controller no longer processes the GitLab push event if the push event payload contains no commit. Instead, it correctly displays an error message warning the user that no commit is attached.

* With this update, the {pac} controller no longer processes the GitLab tag delete event, which caused the controller to crash. Instead, it correctly displays an error message warning the user that deleting the tag event is not supported.

* Before this update, some of the standard variables, header values, and body fields, for example the `body.eventKey` field, were not being resolved in `PipelineRun` resources for the Bitbucket server. With this update, the issue is fixed.

* With this update, the `skopeo-copy` task supports copying multiple images by using the `url.txt` file if the `SOURCE_IMAGE_URL` and `DESTINATION_IMAGE_URL` parameters are left empty.

* Before this update, running the `tkn pac create repo` command on an empty repository resulted in the `.` period symbol being generated as the name of the pipeline run in the template. With this update, the issue is fixed, and the `REPO_NAME.git` is now used as the pipeline run name.

* With this update, the pipeline run failure handling is fixed to accurately report validation failures in the `status.message` field and consistently trigger `finally` tasks, even if a task fails the validation.
