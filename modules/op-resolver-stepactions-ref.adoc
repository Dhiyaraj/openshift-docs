// This module is included in the following assemblies:
// * create/remote-pipelines-tasks-resolvers.adoc

// // *openshift_pipelines/remote-pipelines-tasks-resolvers.adoc
:_mod-docs-content-type: REFERENCE
[id="resolver-stepactions-ref_{context}"]
= Step action provided with {pipelines-shortname}

{pipelines-shortname} provides a standard `StepAction` definition that you can use in your tasks. Use the cluster resolver to reference this definition.

[discrete]
[id="op-stepaction-git-clone_{context}"]
== git-clone

The `git-clone` step action uses Git to initialize and clone a remote repository on a workspace. You can use this step action to define a task that clones a repository at the start of a pipeline that builds or otherwise processes this source code.


.Example usage of the `git-clone` step action in a task
[source,yaml,subs="attributes+"]
----
apiVersion: tekton.dev/v1
kind: Task
metadata:
  name: clone-repo-anon
spec:
# ...  
  steps:
  - name: clone-repo-step
    ref:
      resolver: cluster
      params:
      - name: name
        value: git-clone
      - name: namespace
        value: openshift-pipelines
      - name: kind
        value: stepaction
    params:
    - name: URL
      value: $(params.url)
    - name: OUTPUT_PATH
      value: $(workspaces.output.path)
----

.Supported parameters for the `git-clone` step action
[cols="1,2,1,1",options="header"]
|===
| Parameter | Description | Type | Default value
|`OUTPUT_PATH` | A directory for the fetched Git repository. Cloned repo data is placed in the root of the directory or in the relative path defined by the `SUBDIRECTORY` parameter |`string` |
|`SSH_DIRECTORY_PATH` |A `.ssh` directory with the private key, `known_hosts`, `config`, and other files as necessary. If you provide this directory, the task uses it for authentication to the Git repository. Bind the workspace providing this directory to a `Secret` resource for secure storage of authentication information. |`string` |
|`BASIC_AUTH_PATH` |A directory containing a `.gitconfig` and `.git-credentials` files. If you provide this directgory, the task uses it for authentication to the Git repository. Use a `SSH_DIRECTORY_PATH` directory for authentication instead of `BASIC_AUTH_PATH` whenever possible. Bind the workspace providing this directory to a `Secret` resource for secure storage of authentication information. |`string` |
|`SSL_CA_DIRECTORY_PATH` |A workspace containing CA certificates. If you provide this workspace, Git uses these certificates to verify the peer when interacting with remote repositories using HTTPS. |`string` |
|`CRT_FILENAME` |Certificate authority (CA) bundle filename in the `ssl-ca-directory` workspace. |`string` |`ca-bundle.crt`
|`HTTP_PROXY` |HTTP proxy server (non-TLS requests). |`string` |
|`HTTPS_PROXY` |HTTPS proxy server (TLS requests). |`string` |
|`NO_PROXY` |Opt out of proxying HTTP/HTTPS requests. |`string` |
|`SUBDIRECTORY` |Relative path in the `output` workspace where the task places the Git repository. |`string` |
|`USER_HOME` |Absolute path to the Git user home directory in the pod. |`string` |`/home/git`
|`DELETE_EXISTING` |Delete the contents of the default workspace, if they exist, before running the Git operations. |`string` |`true`
|`VERBOSE` |Log the executed commands. |`string` |`false`
|`SSL_VERIFY` |The global `http.sslVerify` value. Do not set this parameter to to `false` unless you trust the remote repository. |`string` |`true`
|`URL` |Git repository URL. |`string` |
|`REVISION` |The revision to check out, for example, a branch or tag. |`string` |`main`
|`REFSPEC` |The `refspec` string for the repository that the task fetches before checking out the revision. |`string` |
|`SUBMODULES` |Initialize and fetch Git submodules. |`string` |`true`
|`DEPTH` |Number of commits to fetch, a "shallow clone" is a single commit. |`string` |`1`
|`SPARSE_CHECKOUT_DIRECTORIES` |List of directory patterns, separated by commas, for performing a  "sparse checkout". |`string` |
|===

.Results that the `git-clone` step action returns
[cols="1,1,2",options="header"]
|===
| Result | Type | Description
|`COMMIT` |`string` |The SHA digest of the commit that is at the HEAD of the current branch in the cloned Git repository.
|`URL` |`string` |The URL of the repository that was cloned.
|`COMMITTER_DATE` |`string` |The epoch timestamp of the commit that is at the HEAD of the current branch in the cloned Git repository.
|===
