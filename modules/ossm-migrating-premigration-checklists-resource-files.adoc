// Module included in the following assemblies:
//
// * service-mesh-docs-main/migrating/checklists/ossm-migrating-premigration-checklists.adoc

:_mod-docs-content-type: REFERENCE
[id="ossm-migrating-premigration-checklists-resource-files_{context}"]
= Example resource files

After you have completed the premigration procedures, your {SMProduct} 2 resources might be similar to the following examples:

[id="service-mesh-control-plane-resource-file_{context}"]
== The ServiceMeshControlPlane resource file

.Example `ServiceMeshControlPlane` resource

[source, yaml]
----
apiVersion: maistra.io/v2
kind: ServiceMeshControlPlane
metadata:
  name: basic
  namespace: istio-system
spec:
  version: v2.6 <1>
  security: <2>
    manageNetworkPolicy: false
  addons: <3>
    grafana:
      enabled: false
    kiali:
      enabled: false
    prometheus:
      enabled: false
  meshConfig: <4>
    extensionProviders:
      - name: prometheus
        prometheus: {}
      - name: otel
        opentelemetry:
          port: 4317
          service: otel-collector.istio-system.svc.cluster.local
  gateways: <5>
    enabled: false
    openshiftRoute:
      enabled: false
  mode: MultiTenant <6>
  tracing: <7>
    type: None
----
<1> Update your `ServiceMeshControlPlane`  resource to the latest {SMProduct} version.
<2> Disable network policy management.
<3> Disable all resources in the `addons` stanza.
<4> Your `ServiceMeshControlPlane` resource is configured to use external metrics and tracing providers.
<5> Disable managed gateways.
<6> Set to either `MultiTenant` or `ClusterWide`.
<7> Disable tracing.

[id="telemetry-resource-file_{context}"]
== Telemetry resource file

The `Telemetry` resource file is located in your root namespace. The following example uses `istio-system` as the root namespace.

.Example `Telemetry` resource

[source,yaml]
----
apiVersion: telemetry.istio.io/v1
kind: Telemetry
metadata:
  name: mesh-default
  namespace: istio-system
spec:
  metrics: <1>
    - providers:
        - name: prometheus
  tracing: <2>
    - providers:
        - name: otel
----
<1> Specify your metrics provider. The `name` field must match what is specified in your `ServiceMeshControlPlane` resource in the `spec.meshConfig.extensionProviders` field.
<2> Specify yur tracing provider. The `name` field must match what is specified in your `ServiceMeshControlPlane` resource in the `spec.meshConfig.extensionProviders` field.

[id="kiali-resource-file_{context}"]
== Kiali resource file

.Example `Kiali` resource

[source,yaml]
----
apiVersion: kiali.io/v1alpha1
kind: Kiali
metadata:
  name: kiali
  namespace: istio-system
spec:
  version: default <1>
  external_services:
    prometheus: <2>
      auth:
        type: bearer
        use_kiali_token: true
      thanos_proxy:
        enabled: true
      url: https://thanos-querier.openshift-monitoring.svc.cluster.local:9091
    tracing: <3>
      enabled: true
      provider: tempo
      use_grpc: false
      internal_url: http://tempo-sample-query-frontend.tempo:3200
      external_url: https://tempo-sample-query-frontend-tempo.apps-crc.testing
    grafana: <4>
      enabled: false
----
<1> You can use the `default` value of the version parameter if you install {SMProduct} 3 before updating Kiali. The default version is compatible with both 2.6 and 3.0 control planes.
<2> Configure Kiali to use external Prometheus.
<3> Configure Kiali to use the external tracing store.
<4> Disable the Grafana configuration. Grafana is not supported with {SMProduct} 3.0.