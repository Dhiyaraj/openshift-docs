// Module included in the following assemblies:
//
// * service-mesh-docs-main/about/ossm-migrating-assembly.adoc

//Start of an overall Migrating section.
//Section is most likely to be reworked/restructured with OSSM 2 to OSSM 3 migration guides for GA. Unknown how many migration guides there are at this time (11/11/2024). It would be beneficial to be able to link from differences to the relevent migration guide so that users A) understand the change, esp significant changes like new operator, installing tracing and Kiali separately, gateways, etc.

:_mod-docs-content-type: CONCEPT
[id="ossm-migrating-read-me-new-resources_{context}"]
= New resources in {SMProduct} 3

{SMProductName} 3 uses two new resources:

* `Istio` resource
* `IstioCNI` resource

[id="ossm-istio-resource-replaces-smcp_{context}"]
== The Istio resource replaces the ServiceMeshControlPlane resource

{SMProduct} 2 uses a resource called `ServiceMeshControlPlane` to configure Istio. In {SMProduct} 3, the `ServiceMeshControlPlane` resource is replaced with a resource called `Istio`.

The `Istio` resource contains a `spec.values` field that derives its schema from Istio's Helm chart values. This means that configuration examples from the community Istio documentation can often be applied directly to the {SMProduct} 3 `Istio` resource.

The `Istio` resource provides an additional validation schema enabling the ability to explore the resource running the following the {ocp-short-name} command line interface (CLI) command:

[source,terminal]
----
$ oc explain istios.spec.values
----

//Note that there might be an attribute for OpenShift CLI. Check main _attributes file, and if there is an attribute for it, add it to list for service-mesh-docs-main _attributes file.

[id="ossm-new-resource-istiocni_{context}"]
== New resource: IstioCNI

The Istio Container Network Interface (CNI) node agent is used to configure traffic redirection for pods in the mesh. It runs as a daemon set, on every node, with elevated privileges.

In {SMProduct} 2, the Operator deployed an Istio CNI instance for each minor version of Istio present in the cluster, and pods were automatically annotated during sidecar injection so they picked up the correct Istio CNI. While this meant that the management of Istio CNI was mostly hidden from you, it obscured the fact that the Istio CNI agent has an independent lifecycle from the Istio control plane and, in some cases, the Istio CNI agent must be be upgraded separately.

For these reasons, the {SMProduct} 3 Operator manages the Istio CNI node agent with a separate resource called `IstioCNI`. A single instance of this resource is shared by all Istio control planes, which are managed by `Istio` resources.
